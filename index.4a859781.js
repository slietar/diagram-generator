function e(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},r={},a=t.parcelRequire94c2;null==a&&((a=function(e){if(e in n)return n[e].exports;if(e in r){var t=r[e];delete r[e];var a={id:e,exports:{}};return n[e]=a,t.call(a.exports,a,a.exports),a.exports}var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){r[e]=t},t.parcelRequire94c2=a),a.register("dRo73",(function(t,n){var r,a;e(t.exports,"register",(()=>r),(e=>r=e)),e(t.exports,"resolve",(()=>a),(e=>a=e));var o={};r=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)o[t[n]]=e[t[n]]},a=function(e){var t=o[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),a("dRo73").register(JSON.parse('{"7wfW7":"index.4a859781.js","7lvc1":"worker.0a08fc97.js"}'));const o=Symbol("Comlink.proxy"),i=Symbol("Comlink.endpoint"),s=Symbol("Comlink.releaseProxy"),l=Symbol("Comlink.thrown"),c=e=>"object"==typeof e&&null!==e||"function"==typeof e,u=new Map([["proxy",{canHandle:e=>c(e)&&e[o],serialize(e){const{port1:t,port2:n}=new MessageChannel;return d(e,t),[n,[n]]},deserialize:e=>(e.start(),f(e))}],["throw",{canHandle:e=>c(e)&&l in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function d(e,t=self){t.addEventListener("message",(function n(r){if(!r||!r.data)return;const{id:a,type:o,path:i}=Object.assign({path:[]},r.data),s=(r.data.argumentList||[]).map(w);let c;try{const t=i.slice(0,-1).reduce(((e,t)=>e[t]),e),n=i.reduce(((e,t)=>e[t]),e);switch(o){case"GET":c=n;break;case"SET":t[i.slice(-1)[0]]=w(r.data.value),c=!0;break;case"APPLY":c=n.apply(t,s);break;case"CONSTRUCT":c=b(new n(...s));break;case"ENDPOINT":{const{port1:t,port2:n}=new MessageChannel;d(e,n),c=h(t,[t])}break;case"RELEASE":c=void 0;break;default:return}}catch(e){c={value:e,[l]:0}}Promise.resolve(c).catch((e=>({value:e,[l]:0}))).then((e=>{const[r,i]=E(e);t.postMessage(Object.assign(Object.assign({},r),{id:a}),i),"RELEASE"===o&&(t.removeEventListener("message",n),p(t))}))})),t.start&&t.start()}function p(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function f(e,t){return g(e,[],t)}function m(e){if(e)throw new Error("Proxy has been released and is not useable")}function g(e,t=[],n=function(){}){let r=!1;const a=new Proxy(n,{get(n,o){if(m(r),o===s)return()=>L(e,{type:"RELEASE",path:t.map((e=>e.toString()))}).then((()=>{p(e),r=!0}));if("then"===o){if(0===t.length)return{then:()=>a};const n=L(e,{type:"GET",path:t.map((e=>e.toString()))}).then(w);return n.then.bind(n)}return g(e,[...t,o])},set(n,a,o){m(r);const[i,s]=E(o);return L(e,{type:"SET",path:[...t,a].map((e=>e.toString())),value:i},s).then(w)},apply(n,a,o){m(r);const s=t[t.length-1];if(s===i)return L(e,{type:"ENDPOINT"}).then(w);if("bind"===s)return g(e,t.slice(0,-1));const[l,c]=v(o);return L(e,{type:"APPLY",path:t.map((e=>e.toString())),argumentList:l},c).then(w)},construct(n,a){m(r);const[o,i]=v(a);return L(e,{type:"CONSTRUCT",path:t.map((e=>e.toString())),argumentList:o},i).then(w)}});return a}function v(e){const t=e.map(E);return[t.map((e=>e[0])),(n=t.map((e=>e[1])),Array.prototype.concat.apply([],n))];var n}const y=new WeakMap;function h(e,t){return y.set(e,t),e}function b(e){return Object.assign(e,{[o]:!0})}function E(e){for(const[t,n]of u)if(n.canHandle(e)){const[r,a]=n.serialize(e);return[{type:"HANDLER",name:t,value:r},a]}return[{type:"RAW",value:e},y.get(e)||[]]}function w(e){switch(e.type){case"HANDLER":return u.get(e.name).deserialize(e.value);case"RAW":return e.value}}function L(e,t,n){return new Promise((r=>{const a=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.addEventListener("message",(function t(n){n.data&&n.data.id&&n.data.id===a&&(e.removeEventListener("message",t),r(n.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:a},t),n)}))}let S=document.querySelector("form"),R=document.querySelector("pre"),O=document.getElementById("output");S.addEventListener("submit",(e=>{e.preventDefault();let t=new FormData(e.currentTarget),n=t.get("layerMerge"),r=t.get("layerRenderOrder");!async function(e){R.innerText="";let t=e=>{R.innerText+=e+"\n"};if(e.file.size<1)return void t("No file selected");O.innerHTML="",T&&(x.terminate(),x=null);x||(x=new Worker(M));let n=null;if(e.testMode){let e=document.createElement("canvas");O.appendChild(e),n=e.transferControlToOffscreen()}let{compute:r}=f(x);T=!0;let a=await r(h({...e,canvas:n},n?[n]:[]),b(t));if(T=!1,!e.testMode){O.innerHTML=a.svg;let e=O.querySelector("svg"),t=document.createElement("div"),n=document.createElement("div"),r=document.createElement("button");r.innerText="Download",O.appendChild(t),O.appendChild(n),O.appendChild(r);for(let r of O.querySelectorAll("g"))r.addEventListener("mouseenter",(()=>{let a=r.dataset.layerIndex,o=r.dataset.groupIndex;t.innerHTML=`<b>Layer:</b> ${a}`,n.innerHTML=`<b>Group:</b> ${o}`,r.classList.add("_active"),e.classList.add("_selected")})),r.addEventListener("mouseleave",(()=>{r.classList.remove("_active"),e.classList.remove("_selected")}));r.addEventListener("click",(()=>{let e=document.createElement("a");e.style.display="none",e.href=URL.createObjectURL(new Blob([a.svg],{type:"image/svg+xml"})),e.download="diagram.svg",document.body.appendChild(e),e.click(),URL.revokeObjectURL(url)}))}}({colorMode:!0,file:t.get("file"),layerMerge:n?n.split(";").map((e=>e.split(",").map((e=>parseInt(e))))):null,layerRenderOrder:r?r.split(",").map((e=>parseInt(e))):null,minGroupSize:parseFloat(t.get("minGroupSize")),maxGroupSize:parseFloat(t.get("maxGroupSize")),outputWidth:parseInt(t.get("outputWidth")),testMode:"on"!==t.get("vectorGraphics"),tolerance:parseFloat(t.get("tolerance"))})}));let T=!1,x=null;var M,k;k=function(e,t,n){if(t===self.location.origin)return e;var r=n?"import "+JSON.stringify(e)+";":"importScripts("+JSON.stringify(e)+");";return URL.createObjectURL(new Blob([r],{type:"application/javascript"}))};let C=new URL(a("dRo73").resolve("7lvc1"),import.meta.url);M=k(C.toString(),C.origin,!0);